<div class="connection-status-container" *ngIf="isEnabled">
  <div class="connection-status-header">
    <span class="connection-status-title">Connection Status</span>
    <button class="toggle-button" (click)="toggle()" title="Hide connection status">Ã—</button>
  </div>
  <div class="connection-status-items" *ngIf="connectionStatus">
    <div class="connection-item">
      <div class="connection-row">
        <span class="connection-label">WebSocket:</span>
        <span class="connection-value" [class]="getStatusClass(connectionStatus.websocket.status)">
          <span class="status-icon">{{ getStatusIcon(connectionStatus.websocket.status) }}</span>
          {{ connectionStatus.websocket.status }}
        </span>
      </div>
      <div class="traffic-info" *ngIf="connectionStatus.websocket.status === 'connected' && (connectionStatus.websocket.bytesSent || connectionStatus.websocket.bytesReceived)">
        <span class="traffic-sent">â†‘ {{ formatBytes(connectionStatus.websocket.bytesSent || 0) }}</span>
        <span class="traffic-received">â†“ {{ formatBytes(connectionStatus.websocket.bytesReceived || 0) }}</span>
      </div>
    </div>
    <div class="connection-item">
      <div class="connection-row">
        <span class="connection-label">WebRTC:</span>
        <span class="connection-value" [class]="getStatusClass(connectionStatus.webrtc.status)">
          <span class="status-icon">{{ getStatusIcon(connectionStatus.webrtc.status) }}</span>
          {{ connectionStatus.webrtc.status }}
          <span class="status-detail" *ngIf="connectionStatus.webrtc.iceConnectionState">
            ({{ connectionStatus.webrtc.iceConnectionState }})
          </span>
        </span>
      </div>
      <div class="traffic-info" *ngIf="connectionStatus.webrtc.status === 'connected' && (connectionStatus.webrtc.bytesSent || connectionStatus.webrtc.bytesReceived)">
        <span class="traffic-sent">â†‘ {{ formatBytes(connectionStatus.webrtc.bytesSent || 0) }}</span>
        <span class="traffic-received">â†“ {{ formatBytes(connectionStatus.webrtc.bytesReceived || 0) }}</span>
      </div>
    </div>
    <div class="connection-item">
      <div class="connection-row">
        <span class="connection-label">Peer-to-Peer:</span>
        <span class="connection-value" [class]="getStatusClass(connectionStatus.peerToPeer.status)">
          <span class="status-icon">{{ getStatusIcon(connectionStatus.peerToPeer.status) }}</span>
          {{ connectionStatus.peerToPeer.status }}
          <span class="status-detail" *ngIf="connectionStatus.peerToPeer.iceConnectionState">
            ({{ connectionStatus.peerToPeer.iceConnectionState }})
          </span>
        </span>
      </div>
      <div class="traffic-info" *ngIf="connectionStatus.peerToPeer.status === 'connected' && (connectionStatus.peerToPeer.bytesSent || connectionStatus.peerToPeer.bytesReceived)">
        <span class="traffic-sent">â†‘ {{ formatBytes(connectionStatus.peerToPeer.bytesSent || 0) }}</span>
        <span class="traffic-received">â†“ {{ formatBytes(connectionStatus.peerToPeer.bytesReceived || 0) }}</span>
      </div>
      <div class="ip-info" *ngIf="connectionStatus.peerToPeer.status === 'connected' && (connectionStatus.peerToPeer.localIP || connectionStatus.peerToPeer.remoteIP)">
        <div class="ip-row" *ngIf="connectionStatus.peerToPeer.localIP">
          <span class="ip-label">Local:</span>
          <span class="ip-value">{{ connectionStatus.peerToPeer.localIP }}:{{ connectionStatus.peerToPeer.localPort || 'N/A' }}</span>
        </div>
        <div class="ip-row" *ngIf="connectionStatus.peerToPeer.remoteIP">
          <span class="ip-label">Remote:</span>
          <span class="ip-value">{{ connectionStatus.peerToPeer.remoteIP }}:{{ connectionStatus.peerToPeer.remotePort || 'N/A' }}</span>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="connection-status-toggle" *ngIf="!isEnabled">
  <button class="toggle-button-show" (click)="toggle()" title="Show connection status">
    ðŸ“¡
  </button>
</div>

